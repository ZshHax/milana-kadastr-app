import streamlit as st
import pandas as pd
import plotly.express as px

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(page_title="–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ó–µ–º–µ–ª—å | –ö–∞–¥–∞—Å—Ç—Ä", page_icon="üå±", layout="wide")

# ==========================================
# –ë–û–ö–û–í–ê–Ø –ü–ê–ù–ï–õ–¨ (–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–∫–µ)
# ==========================================
with st.sidebar:
    st.markdown("### üéì –ü–∞—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞")
    st.markdown("---")
    st.markdown("**–í—ã–ø–æ–ª–Ω–∏–ª–∞:** \n–ö–æ—à–∞–Ω–æ–≤–∞ –ú–∏–ª–∞–Ω–∞ –ó–∏—è—Ç—Ö–∞–Ω–æ–≤–Ω–∞")
    st.markdown("**–§–∞–∫—É–ª—å—Ç–µ—Ç:** \n–ê–≥—Ä–∞—Ä–Ω—ã–π")
    st.markdown("**–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:** \n–ö–∞–¥–∞—Å—Ç—Ä")
    st.markdown("**–ì—Ä—É–ø–ø–∞:** \n–ê–ø 24-6—Ä")
    st.markdown("---")
    st.markdown("**–ë–∞–∑–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏:** \n–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∑–µ–º–µ–ª—å–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏")
    st.markdown("**–¢–µ–º–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:** \n*¬´–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–µ–º–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤¬ª*")
    st.markdown("---")
    st.info("üí° –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –∑–∞—â–∏—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ I (2026 –≥.).")

# ==========================================
# –û–°–ù–û–í–ù–ê–Ø –ß–ê–°–¢–¨ (–î–∞—à–±–æ—Ä–¥)
# ==========================================

# –ó–∞–≥–æ–ª–æ–≤–æ–∫
st.title("üå± –î–∞—à–±–æ—Ä–¥: –†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–µ–º–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤")
st.markdown("**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞**")

# –°–æ–∑–¥–∞–µ–º –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
tab1, tab2 = st.tabs(["üìä –ë–∞–ª–∞–Ω—Å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–µ–º–µ–ª—å", "üí∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–∞–Ω–∫—Ü–∏–π"])

with tab1:
    st.subheader("–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞ (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)")

    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
    data = {
        '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': [
            '–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ (–ø–∞—à–Ω–∏, –ø–∞—Å—Ç–±–∏—â–∞)',
            '–ó–µ–º–ª–∏ –∑–∞–ø–∞—Å–∞',
            '–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ / –î–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ',
            '–ó–µ–º–ª–∏ –Ω–∞—Å–µ–ª–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤'
        ],
        '–ü–ª–æ—â–∞–¥—å (—Ç—ã—Å. –≥–∞)': [450, 150, 80, 120]
    }
    df = pd.DataFrame(data)

    # –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ Plotly
    fig = px.pie(df, values='–ü–ª–æ—â–∞–¥—å (—Ç—ã—Å. –≥–∞)', names='–ö–∞—Ç–µ–≥–æ—Ä–∏—è', hole=0.4,
                 color_discrete_sequence=px.colors.sequential.Greens_r)
    fig.update_traces(textposition='inside', textinfo='percent+label')

    # –í—ã–≤–æ–¥ –≥—Ä–∞—Ñ–∏–∫–∞
    st.plotly_chart(fig, use_container_width=True)

    st.success(
        "‚úÖ **–ê–Ω–∞–ª–∏–∑:** –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å –∑–µ–º–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –æ–¥–Ω–∞–∫–æ 80 —Ç—ã—Å. –≥–∞ —Ç—Ä–µ–±—É—é—Ç –º–µ—Ä –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è.")

with tab2:
    st.subheader("–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞—Å—á–µ—Ç–∞ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞")

    col1, col2 = st.columns(2)

    with col1:
        # –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
        area = st.number_input("–ü–ª–æ—â–∞–¥—å —É—á–∞—Å—Ç–∫–∞ —Å –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º (–≤ –≥–µ–∫—Ç–∞—Ä–∞—Ö):", min_value=0.1, value=5.0, step=0.5)

        # –¢–∏–ø –Ω–∞—Ä—É—à–µ–Ω–∏—è
        violation_type = st.selectbox(
            "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –Ω–∞—Ä—É—à–µ–Ω–∏—è:",
            ["–ù–µ—Ü–µ–ª–µ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞",
             "–ü–æ—Ä—á–∞ –∑–µ–º–µ–ª—å (—ç—Ä–æ–∑–∏—è, –∑–∞—Ö–ª–∞–º–ª–µ–Ω–∏–µ)",
             "–°–∞–º–æ–≤–æ–ª—å–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞"]
        )

        # –°—É–±—ä–µ–∫—Ç
        subject = st.radio("–°—É–±—ä–µ–∫—Ç –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–µ–Ω–∏—è:", ["–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ", "–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å", "–ö—Ä—É–ø–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ"])

    with col2:
        st.markdown("### –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞:")
        # –ë–∞–∑–æ–≤—ã–π –ú–†–ü –Ω–∞ 2026 –≥–æ–¥ (–ø—Ä–∏–º–µ—Ä–Ω—ã–π)
        mrp = 3932

        # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
        multiplier = 10
        if subject == "–ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å":
            multiplier = 40
        elif subject == "–ö—Ä—É–ø–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ":
            multiplier = 100

        if violation_type == "–ü–æ—Ä—á–∞ –∑–µ–º–µ–ª—å (—ç—Ä–æ–∑–∏—è, –∑–∞—Ö–ª–∞–º–ª–µ–Ω–∏–µ)":
            multiplier *= 1.5
        elif violation_type == "–°–∞–º–æ–≤–æ–ª—å–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∑–µ–º–µ–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞":
            multiplier *= 2

        total_fine = int((mrp * multiplier) * (1 + (area * 0.1)))

        st.metric(label="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ —à—Ç—Ä–∞—Ñ–∞ (–¢–µ–Ω–≥–µ):", value=f"{total_fine:,}".replace(',', ' '))
        st.warning("‚ö†Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–µ–π –ö–æ–ê–ü –†–ö.")